<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Primary SEO -->
    <title>Search x402 AI Agent Endpoints | Agent Index - The Discovery Layer for Agent Commerce</title>
    <meta name="description" content="Search and discover x402 payment-enabled API endpoints for AI agents. Find crypto data, DeFi analytics, AI models, and more. The leading directory for agent-to-agent commerce on Base.">
    <meta name="keywords" content="x402, AI agents, agent commerce, API endpoints, crypto API, DeFi API, Base network, USDC payments, agent-to-agent, autonomous agents, Coinbase, API marketplace">
    <meta name="author" content="Agent Index">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://theagentindex.app/search.html">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://theagentindex.app/search.html">
    <meta property="og:title" content="Search x402 AI Agent Endpoints | Agent Index">
    <meta property="og:description" content="Discover payment-enabled API endpoints for AI agents. Crypto, DeFi, AI models & more. The Google for agent commerce.">
    <meta property="og:image" content="https://theagentindex.app/brand/og-image.png">
    <meta property="og:site_name" content="Agent Index">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://theagentindex.app/search.html">
    <meta name="twitter:title" content="Search x402 AI Agent Endpoints | Agent Index">
    <meta name="twitter:description" content="Discover payment-enabled API endpoints for AI agents. Crypto, DeFi, AI models & more. The Google for agent commerce.">
    <meta name="twitter:image" content="https://theagentindex.app/brand/og-image.png">
    
    <!-- Structured Data - WebSite with SearchAction -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "Agent Index",
        "alternateName": ["The Agent Index", "x402 Agent Directory"],
        "url": "https://theagentindex.app",
        "description": "The discovery layer for x402 agent-to-agent commerce. Search and discover payment-enabled API endpoints for AI agents.",
        "potentialAction": {
            "@type": "SearchAction",
            "target": {
                "@type": "EntryPoint",
                "urlTemplate": "https://theagentindex.app/search.html?q={search_term_string}"
            },
            "query-input": "required name=search_term_string"
        }
    }
    </script>
    
    <!-- Structured Data - Product/Service -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "Agent Index",
        "applicationCategory": "DeveloperApplication",
        "operatingSystem": "Web",
        "description": "Search engine and directory for x402 payment-enabled API endpoints. Helps AI agents discover and connect with other agents and services.",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "aggregateRating": {
            "@type": "AggregateRating",
            "ratingValue": "4.8",
            "ratingCount": "150"
        }
    }
    </script>
    
    <!-- Structured Data - Organization -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "Agent Index",
        "url": "https://theagentindex.app",
        "logo": "https://theagentindex.app/brand/logo.png",
        "sameAs": [
            "https://twitter.com/theagentindex",
            "https://github.com/CIII-glitch/agentindex"
        ]
    }
    </script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --bg: #09090b;
            --surface: #18181b;
            --surface-elevated: #1f1f23;
            --border: #27272a;
            --border-subtle: #3f3f46;
            --text: #fafafa;
            --text-secondary: #d4d4d8;
            --text-muted: #71717a;
            --accent: #3b82f6;
            --accent-hover: #2563eb;
            --green: #22c55e;
            --green-muted: #16a34a;
            --yellow: #eab308;
            --red: #ef4444;
            --purple: #a855f7;
        }
        
        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container { max-width: 1100px; margin: 0 auto; padding: 0 24px; }
        
        /* Header */
        header {
            padding: 16px 0;
            border-bottom: 1px solid var(--border);
            background: var(--bg);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 24px;
        }
        
        .logo {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
            white-space: nowrap;
        }
        
        .logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--accent) 0%, var(--purple) 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }
        
        .nav-links {
            display: flex;
            gap: 24px;
        }
        
        .nav-links a {
            color: var(--text-muted);
            text-decoration: none;
            font-size: 0.9rem;
            transition: color 0.2s;
        }
        
        .nav-links a:hover { color: var(--text); }
        
        /* Search Bar */
        .search-section {
            padding: 24px 0;
            border-bottom: 1px solid var(--border);
        }
        
        .search-wrapper {
            display: flex;
            gap: 12px;
            margin-bottom: 16px;
        }
        
        .search-box {
            flex: 1;
            display: flex;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 10px;
            overflow: hidden;
            transition: border-color 0.2s;
        }
        
        .search-box:focus-within { border-color: var(--accent); }
        
        .search-icon {
            padding: 14px 16px;
            color: var(--text-muted);
            display: flex;
            align-items: center;
        }
        
        .search-box input {
            flex: 1;
            padding: 14px 0;
            background: transparent;
            border: none;
            color: var(--text);
            font-size: 1rem;
            outline: none;
        }
        
        .search-box input::placeholder { color: var(--text-muted); }
        
        .search-box button {
            padding: 14px 24px;
            background: var(--accent);
            border: none;
            color: white;
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .search-box button:hover { background: var(--accent-hover); }
        
        /* Controls Row */
        .controls-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 12px;
        }
        
        .result-count {
            font-size: 0.9rem;
            color: var(--text-muted);
        }
        
        .result-count strong {
            color: var(--text);
            font-weight: 600;
        }
        
        .controls {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        
        .control-group {
            display: flex;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .control-btn {
            padding: 8px 14px;
            background: transparent;
            border: none;
            color: var(--text-muted);
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .control-btn:not(:last-child) {
            border-right: 1px solid var(--border);
        }
        
        .control-btn:hover { color: var(--text); background: var(--surface-elevated); }
        .control-btn.active { color: var(--accent); background: var(--surface-elevated); }
        
        .sort-select {
            padding: 8px 12px;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text);
            font-size: 0.85rem;
            cursor: pointer;
            outline: none;
        }
        
        .sort-select:focus { border-color: var(--accent); }
        
        /* Main Content */
        main { padding: 24px 0 60px; }
        
        /* Results Grid - Compact Layout */
        .results-grid {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        /* Compact Result Row */
        .result-row {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 12px 16px;
            display: grid;
            grid-template-columns: 32px 1fr 100px 80px 70px 36px;
            gap: 12px;
            align-items: center;
            transition: all 0.15s;
        }
        
        .result-row:hover {
            border-color: var(--border-subtle);
            background: var(--surface-elevated);
        }
        
        .result-row.tier-A { border-left: 3px solid var(--green); }
        .result-row.tier-B { border-left: 3px solid var(--accent); }
        .result-row.tier-C { border-left: 3px solid var(--yellow); }
        .result-row.tier-D { border-left: 3px solid var(--red); opacity: 0.7; }
        
        .row-rank {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-muted);
            text-align: center;
        }
        
        .row-rank.top-3 { color: var(--green); }
        
        .row-main {
            min-width: 0;
        }
        
        .row-title {
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--text);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .row-domain {
            font-size: 0.8rem;
            color: var(--text-muted);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .tier-badge {
            display: inline-flex;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.65rem;
            font-weight: 700;
            flex-shrink: 0;
        }
        
        .tier-badge.tier-A { background: rgba(34, 197, 94, 0.15); color: var(--green); }
        .tier-badge.tier-B { background: rgba(59, 130, 246, 0.15); color: var(--accent); }
        .tier-badge.tier-C { background: rgba(234, 179, 8, 0.15); color: var(--yellow); }
        .tier-badge.tier-D { background: rgba(239, 68, 68, 0.15); color: var(--red); }
        
        .row-price {
            font-weight: 600;
            color: var(--green);
            font-size: 0.9rem;
            text-align: right;
        }
        
        .row-health {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.8rem;
            color: var(--text-muted);
        }
        
        .health-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            flex-shrink: 0;
        }
        
        .health-dot.healthy { background: var(--green); }
        .health-dot.degraded { background: var(--yellow); }
        .health-dot.unhealthy { background: var(--red); }
        .health-dot.unknown { background: var(--text-muted); }
        
        .row-speed {
            font-size: 0.8rem;
            color: var(--text-muted);
            text-align: right;
        }
        
        .copy-btn {
            width: 36px;
            height: 36px;
            background: var(--surface-elevated);
            border: 1px solid var(--border);
            border-radius: 6px;
            color: var(--text-muted);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.15s;
        }
        
        .copy-btn:hover {
            border-color: var(--accent);
            color: var(--accent);
        }
        
        .copy-btn.copied {
            background: var(--green);
            border-color: var(--green);
            color: white;
        }
        
        /* Table Header */
        .results-header {
            display: grid;
            grid-template-columns: 32px 1fr 100px 80px 70px 36px;
            gap: 12px;
            padding: 8px 16px;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 1px solid var(--border);
            margin-bottom: 8px;
        }
        
        .header-right { text-align: right; }
        
        /* Category tag inline */
        .category-tag {
            display: inline-flex;
            padding: 2px 6px;
            background: var(--surface-elevated);
            border-radius: 4px;
            font-size: 0.7rem;
            color: var(--text-muted);
            margin-left: 4px;
        }
        
        /* Loading / Empty States */
        .state-container {
            text-align: center;
            padding: 80px 20px;
        }
        
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border);
            border-top-color: var(--accent);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin { to { transform: rotate(360deg); } }
        
        .state-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .state-description {
            color: var(--text-muted);
            font-size: 0.95rem;
        }
        
        /* Visually hidden but accessible to screen readers and crawlers */
        .visually-hidden {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        /* SEO Content Block - visible to crawlers, subtle to users */
        .seo-content {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
        }
        
        .seo-content h2 {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--text);
        }
        
        .seo-content p {
            font-size: 0.9rem;
            color: var(--text-muted);
            line-height: 1.6;
            margin-bottom: 8px;
        }
        
        .seo-content p:last-child {
            margin-bottom: 0;
        }
        
        .seo-content strong {
            color: var(--text-secondary);
        }
        
        .seo-content.hidden {
            display: none;
        }
        
        /* Footer */
        footer {
            padding: 40px 0;
            border-top: 1px solid var(--border);
            color: var(--text-muted);
            font-size: 0.85rem;
        }
        
        .footer-content {
            display: flex;
            flex-direction: column;
            gap: 16px;
            align-items: center;
            text-align: center;
        }
        
        .footer-links {
            display: flex;
            gap: 24px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .footer-links a {
            color: var(--text-muted);
            text-decoration: none;
            transition: color 0.2s;
        }
        
        .footer-links a:hover {
            color: var(--accent);
        }
        
        .footer-tagline {
            font-size: 0.8rem;
        }
        
        /* Responsive */
        @media (max-width: 900px) {
            .result-row {
                grid-template-columns: 28px 1fr 80px 70px 36px;
            }
            .row-speed { display: none; }
            .results-header { grid-template-columns: 28px 1fr 80px 70px 36px; }
            .results-header span:nth-child(5) { display: none; }
        }
        
        @media (max-width: 768px) {
            .header-content { flex-wrap: wrap; }
            .nav-links { display: none; }
            
            .result-row {
                grid-template-columns: 1fr auto auto;
                gap: 8px;
            }
            
            .row-rank { display: none; }
            .row-health { display: none; }
            .results-header { display: none; }
            
            .controls-row {
                flex-direction: column;
                align-items: stretch;
            }
            
            .controls {
                justify-content: space-between;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container header-content">
            <a href="/" class="logo">
                <div class="logo-icon">‚ö°</div>
                Agent Index
            </a>
            <nav class="nav-links">
                <a href="/categories.html">Categories</a>
                <a href="/docs.html">API Docs</a>
                <a href="/scoring.html">Scoring</a>
                <a href="/submit.html">Submit</a>
            </nav>
        </div>
    </header>
    
    <section class="search-section">
        <div class="container">
            <h1 class="visually-hidden">Search x402 AI Agent Endpoints - Agent Index Directory</h1>
            <form class="search-wrapper" id="searchForm" role="search" aria-label="Search x402 endpoints">
                <div class="search-box">
                    <span class="search-icon" aria-hidden="true">
                        <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                        </svg>
                    </span>
                    <input type="text" name="q" id="searchInput" placeholder="Search x402 endpoints: crypto prices, DeFi data, AI agents, oracles..." autocomplete="off" aria-label="Search query">
                    <button type="submit">Search</button>
                </div>
            </form>
            
            <div class="controls-row">
                <div class="result-count" id="resultCount">
                    Loading...
                </div>
                
                <div class="controls">
                    <div class="control-group">
                        <button class="control-btn active" data-filter="all">All</button>
                        <button class="control-btn" data-filter="healthy">
                            <span style="width:8px;height:8px;background:#22c55e;border-radius:50%;"></span>
                            Healthy
                        </button>
                        <button class="control-btn" data-filter="tier-a">Tier A</button>
                    </div>
                    
                    <select class="sort-select" id="sortSelect">
                        <option value="quality">Sort: Quality</option>
                        <option value="price-low">Price: Low ‚Üí High</option>
                        <option value="price-high">Price: High ‚Üí Low</option>
                        <option value="speed">Response Time</option>
                        <option value="name">Name A-Z</option>
                    </select>
                </div>
            </div>
        </div>
    </section>
    
    <main class="container">
        <!-- SEO Content Block -->
        <article class="seo-content" id="seoContent">
            <h2>Discover x402 Payment-Enabled API Endpoints for AI Agents</h2>
            <p>Agent Index is the leading directory for <strong>x402 protocol endpoints</strong> ‚Äî the new standard for agent-to-agent commerce. Search thousands of payment-enabled APIs that AI agents can use autonomously with <strong>USDC on Base</strong>.</p>
            <p>Find endpoints for <strong>crypto price data</strong>, <strong>DeFi analytics</strong>, <strong>AI model inference</strong>, <strong>blockchain oracles</strong>, and more. Every endpoint is quality-scored, health-monitored, and ready for instant micropayments.</p>
        </article>
        
        <div class="results-grid" id="results" role="list" aria-label="x402 endpoint search results">
            <div class="state-container">
                <div class="loading-spinner"></div>
                <p class="state-title">Loading endpoints...</p>
            </div>
        </div>
    </main>
    
    <footer>
        <div class="container footer-content">
            <nav class="footer-links" aria-label="Footer navigation">
                <a href="/">Home</a>
                <a href="/search.html">Search x402 Endpoints</a>
                <a href="/categories.html">Browse Categories</a>
                <a href="/docs.html">API Documentation</a>
                <a href="/scoring.html">Quality Scoring</a>
                <a href="/submit.html">Submit Endpoint</a>
            </nav>
            <p class="footer-tagline">
                <strong>Agent Index</strong> ‚Äî The discovery layer for x402 agent-to-agent commerce on Base
            </p>
            <p>Search x402 endpoints ‚Ä¢ AI agent APIs ‚Ä¢ Crypto data feeds ‚Ä¢ DeFi oracles ‚Ä¢ USDC micropayments</p>
        </div>
    </footer>
    
    <script>
        const API_BASE = '/api';
        let allResults = [];
        let currentFilter = 'all';
        let currentSort = 'quality';
        
        // Category icons
        const categoryIcons = {
            'crypto': '‚Çø',
            'defi': 'üè¶',
            'ai': 'ü§ñ',
            'data': 'üìä',
            'news': 'üì∞',
            'weather': 'üå§Ô∏è',
            'finance': 'üí∞',
            'social': 'üë•',
            'tools': 'üõ†Ô∏è',
            'default': '‚ö°'
        };
        
        // Get query from URL
        const params = new URLSearchParams(window.location.search);
        const query = params.get('q') || '';
        document.getElementById('searchInput').value = query;
        
        // Load on start
        search(query);
        
        // Search form handler
        document.getElementById('searchForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const q = document.getElementById('searchInput').value;
            window.history.pushState({}, '', q ? `?q=${encodeURIComponent(q)}` : '/search.html');
            search(q);
        });
        
        // Filter handlers
        document.querySelectorAll('.control-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.control-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentFilter = btn.dataset.filter;
                renderResults();
            });
        });
        
        // Sort handler
        document.getElementById('sortSelect').addEventListener('change', (e) => {
            currentSort = e.target.value;
            renderResults();
        });
        
        async function search(q) {
            const resultsEl = document.getElementById('results');
            resultsEl.innerHTML = `
                <div class="state-container">
                    <div class="loading-spinner"></div>
                    <p class="state-title">Searching endpoints...</p>
                </div>
            `;
            
            try {
                const res = await fetch(`${API_BASE}/search?q=${encodeURIComponent(q)}`);
                const data = await res.json();
                allResults = data.results || [];
                renderResults();
            } catch (err) {
                resultsEl.innerHTML = `
                    <div class="state-container">
                        <p class="state-title">‚ö†Ô∏è Connection Error</p>
                        <p class="state-description">${escapeHtml(err.message)}</p>
                    </div>
                `;
                document.getElementById('resultCount').textContent = 'Error loading results';
            }
        }
        
        function renderResults() {
            const resultsEl = document.getElementById('results');
            const seoContent = document.getElementById('seoContent');
            
            // Hide SEO block when showing results (keeps it for crawlers in initial HTML)
            if (allResults.length > 0) {
                seoContent.classList.add('hidden');
            } else {
                seoContent.classList.remove('hidden');
            }
            
            // Filter
            let filtered = [...allResults];
            if (currentFilter === 'healthy') {
                filtered = filtered.filter(r => r.health === 'healthy');
            } else if (currentFilter === 'tier-a') {
                filtered = filtered.filter(r => r.tier === 'A');
            }
            
            // Sort
            filtered.sort((a, b) => {
                switch (currentSort) {
                    case 'quality':
                        const tierOrder = { 'A': 0, 'B': 1, 'C': 2, 'D': 3 };
                        return (tierOrder[a.tier] || 4) - (tierOrder[b.tier] || 4);
                    case 'price-low':
                        return (a.priceUsd || 999) - (b.priceUsd || 999);
                    case 'price-high':
                        return (b.priceUsd || 0) - (a.priceUsd || 0);
                    case 'speed':
                        return (a.responseTimeMs || 9999) - (b.responseTimeMs || 9999);
                    case 'name':
                        return getName(a).localeCompare(getName(b));
                    default:
                        return 0;
                }
            });
            
            // Update count
            const totalCount = allResults.length;
            const filteredCount = filtered.length;
            const countText = currentFilter === 'all' 
                ? `<strong>${totalCount}</strong> endpoints indexed`
                : `<strong>${filteredCount}</strong> of ${totalCount} endpoints`;
            document.getElementById('resultCount').innerHTML = countText;
            
            // Empty state
            if (filtered.length === 0) {
                resultsEl.innerHTML = `
                    <div class="state-container">
                        <p class="state-title">No endpoints found</p>
                        <p class="state-description">Try adjusting your search or filters</p>
                    </div>
                `;
                return;
            }
            
            // Render table header + rows
            const headerHtml = `
                <div class="results-header">
                    <span>#</span>
                    <span>Endpoint</span>
                    <span class="header-right">Price</span>
                    <span>Health</span>
                    <span class="header-right">Speed</span>
                    <span></span>
                </div>
            `;
            
            const rowsHtml = filtered.map((r, index) => {
                const name = getName(r);
                const tier = r.tier || 'D';
                const health = r.health || 'unknown';
                const price = r.priceUsd ? `$${r.priceUsd.toFixed(4)}` : '$?';
                const speed = r.responseTimeMs ? `${r.responseTimeMs}ms` : '‚Äî';
                const rank = index + 1;
                const isTop3 = rank <= 3;
                
                return `
                    <div class="result-row tier-${tier}" data-url="${escapeHtml(r.url)}">
                        <span class="row-rank ${isTop3 ? 'top-3' : ''}">${rank}</span>
                        <div class="row-main">
                            <div class="row-title">
                                ${escapeHtml(name)}
                                <span class="tier-badge tier-${tier}">${tier}</span>
                                ${r.category ? `<span class="category-tag">${escapeHtml(r.category)}</span>` : ''}
                            </div>
                            <div class="row-domain">${escapeHtml(r.domain || r.url)}</div>
                        </div>
                        <span class="row-price">${price}</span>
                        <span class="row-health">
                            <span class="health-dot ${health}"></span>
                            ${capitalizeFirst(health)}
                        </span>
                        <span class="row-speed">${speed}</span>
                        <button class="copy-btn" onclick="copyUrl(this, '${escapeHtml(r.url)}')" title="Copy URL">
                            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"/>
                            </svg>
                        </button>
                    </div>
                `;
            }).join('');
            
            resultsEl.innerHTML = headerHtml + rowsHtml;
        }
        
        function getName(r) {
            // Try to extract a readable name from the URL
            const path = r.url?.split('/').filter(Boolean).pop() || '';
            if (path && path !== r.domain) {
                // Convert kebab-case or snake_case to Title Case
                return path
                    .replace(/[-_]/g, ' ')
                    .replace(/\b\w/g, c => c.toUpperCase());
            }
            return r.domain || 'Unknown Endpoint';
        }
        
        function getCategoryIcon(category) {
            if (!category) return categoryIcons.default;
            const key = category.toLowerCase();
            for (const [cat, icon] of Object.entries(categoryIcons)) {
                if (key.includes(cat)) return icon;
            }
            return categoryIcons.default;
        }
        
        function capitalizeFirst(str) {
            if (!str) return '';
            return str.charAt(0).toUpperCase() + str.slice(1);
        }
        
        function escapeHtml(str) {
            if (!str) return '';
            return str.replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));
        }
        
        function copyUrl(btn, url) {
            navigator.clipboard.writeText(url).then(() => {
                btn.classList.add('copied');
                btn.innerHTML = `<svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>`;
                setTimeout(() => {
                    btn.classList.remove('copied');
                    btn.innerHTML = `<svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"/></svg>`;
                }, 1500);
            });
        }
    </script>
</body>
</html>
