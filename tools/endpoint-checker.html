<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>x402 Endpoint Checker ‚Äî Free Tool | Agent Index</title>
    <meta name="description" content="Check if any URL is x402 compatible. Verify payment requirements, pricing, and health status instantly. Free tool by Agent Index.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --bg: #0a0a0b;
            --surface: #141416;
            --border: #27272a;
            --text: #fafafa;
            --text-muted: #a1a1aa;
            --accent: #3b82f6;
            --green: #22c55e;
            --red: #ef4444;
            --yellow: #eab308;
        }
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); line-height: 1.6; min-height: 100vh; }
        .container { max-width: 700px; margin: 0 auto; padding: 40px 24px; }
        header { text-align: center; margin-bottom: 48px; }
        .badge { display: inline-block; padding: 6px 16px; background: var(--surface); border: 1px solid var(--border); border-radius: 20px; font-size: 0.85rem; color: var(--text-muted); margin-bottom: 16px; }
        h1 { font-size: 2.5rem; margin-bottom: 12px; }
        .subtitle { color: var(--text-muted); font-size: 1.1rem; }
        
        .checker-box { background: var(--surface); border: 1px solid var(--border); border-radius: 16px; padding: 32px; margin-bottom: 32px; }
        .input-group { display: flex; gap: 12px; margin-bottom: 16px; }
        .input-group input { flex: 1; padding: 16px 20px; background: var(--bg); border: 1px solid var(--border); border-radius: 10px; color: var(--text); font-size: 1rem; outline: none; transition: border-color 0.2s; }
        .input-group input:focus { border-color: var(--accent); }
        .input-group input::placeholder { color: var(--text-muted); }
        .input-group button { padding: 16px 32px; background: var(--accent); border: none; border-radius: 10px; color: white; font-size: 1rem; font-weight: 600; cursor: pointer; transition: background 0.2s; white-space: nowrap; }
        .input-group button:hover { background: #2563eb; }
        .input-group button:disabled { opacity: 0.5; cursor: not-allowed; }
        .helper-text { font-size: 0.85rem; color: var(--text-muted); }
        
        .results { display: none; }
        .results.show { display: block; }
        
        .result-card { background: var(--surface); border: 1px solid var(--border); border-radius: 16px; padding: 32px; margin-bottom: 24px; }
        .result-card.success { border-color: var(--green); }
        .result-card.error { border-color: var(--red); }
        .result-card.warning { border-color: var(--yellow); }
        
        .result-header { display: flex; align-items: center; gap: 12px; margin-bottom: 20px; }
        .result-icon { width: 48px; height: 48px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; }
        .result-icon.success { background: rgba(34, 197, 94, 0.2); }
        .result-icon.error { background: rgba(239, 68, 68, 0.2); }
        .result-icon.warning { background: rgba(234, 179, 8, 0.2); }
        .result-title { font-size: 1.25rem; font-weight: 600; }
        .result-subtitle { color: var(--text-muted); font-size: 0.9rem; }
        
        .result-details { display: grid; gap: 16px; }
        .detail-row { display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid var(--border); }
        .detail-row:last-child { border-bottom: none; }
        .detail-label { color: var(--text-muted); }
        .detail-value { font-weight: 500; font-family: 'JetBrains Mono', monospace; }
        .detail-value.good { color: var(--green); }
        .detail-value.bad { color: var(--red); }
        
        .cta-box { background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%); border: 1px solid var(--accent); border-radius: 16px; padding: 32px; text-align: center; margin-top: 32px; }
        .cta-box h3 { font-size: 1.25rem; margin-bottom: 8px; }
        .cta-box p { color: var(--text-muted); margin-bottom: 20px; }
        .cta-button { display: inline-block; padding: 14px 28px; background: var(--accent); color: white; text-decoration: none; border-radius: 10px; font-weight: 600; transition: background 0.2s; }
        .cta-button:hover { background: #2563eb; }
        
        .features { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 48px; }
        .feature { text-align: center; padding: 24px; }
        .feature-icon { font-size: 2rem; margin-bottom: 12px; }
        .feature-title { font-weight: 600; margin-bottom: 4px; }
        .feature-desc { color: var(--text-muted); font-size: 0.9rem; }
        
        .email-capture { background: var(--surface); border: 1px solid var(--border); border-radius: 16px; padding: 32px; margin-top: 48px; text-align: center; }
        .email-capture h3 { margin-bottom: 8px; }
        .email-capture p { color: var(--text-muted); margin-bottom: 20px; }
        .email-form { display: flex; gap: 12px; max-width: 400px; margin: 0 auto; }
        .email-form input { flex: 1; padding: 12px 16px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px; color: var(--text); }
        .email-form button { padding: 12px 24px; background: var(--accent); border: none; border-radius: 8px; color: white; font-weight: 500; cursor: pointer; }
        
        footer { text-align: center; margin-top: 48px; padding-top: 24px; border-top: 1px solid var(--border); color: var(--text-muted); font-size: 0.9rem; }
        footer a { color: var(--accent); text-decoration: none; }
        
        .loading { display: none; align-items: center; justify-content: center; gap: 8px; padding: 20px; }
        .loading.show { display: flex; }
        .spinner { width: 20px; height: 20px; border: 2px solid var(--border); border-top-color: var(--accent); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        
        @media (max-width: 600px) {
            h1 { font-size: 1.8rem; }
            .input-group { flex-direction: column; }
            .email-form { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="badge">üîß Free Tool</div>
            <h1>x402 Endpoint Checker</h1>
            <p class="subtitle">Check if any URL is x402 payment-enabled. Instant verification.</p>
        </header>
        
        <div class="checker-box">
            <div class="input-group">
                <input type="url" id="urlInput" placeholder="https://api.example.com/endpoint" autofocus>
                <button id="checkBtn" onclick="checkEndpoint()">Check</button>
            </div>
            <p class="helper-text">Enter any API endpoint URL to check x402 compatibility</p>
        </div>
        
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <span>Checking endpoint...</span>
        </div>
        
        <div class="results" id="results">
            <!-- Results will be inserted here -->
        </div>
        
        <div class="cta-box" id="cta" style="display: none;">
            <h3>üìç List This Endpoint</h3>
            <p>Get discovered by AI agents. Add your endpoint to Agent Index for free.</p>
            <a href="/submit.html" class="cta-button">Submit to Agent Index ‚Üí</a>
        </div>
        
        <div class="features">
            <div class="feature">
                <div class="feature-icon">‚ö°</div>
                <div class="feature-title">Instant Check</div>
                <div class="feature-desc">Results in seconds</div>
            </div>
            <div class="feature">
                <div class="feature-icon">üí∞</div>
                <div class="feature-title">Price Detection</div>
                <div class="feature-desc">See payment requirements</div>
            </div>
            <div class="feature">
                <div class="feature-icon">üîí</div>
                <div class="feature-title">Health Status</div>
                <div class="feature-desc">Verify endpoint health</div>
            </div>
        </div>
        
        <div class="build-section" style="background: var(--surface); border: 1px solid var(--border); border-radius: 16px; padding: 32px; margin-top: 48px;">
            <h3 style="margin-bottom: 8px; font-size: 1.25rem;">üöÄ Ready to Build Your Own x402 Endpoint?</h3>
            <p style="color: var(--text-muted); margin-bottom: 24px;">Deploy your own payment-enabled API and start earning from AI agents.</p>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px;">
                <a href="https://railway.app?referralCode=K1NAm9" target="_blank" rel="noopener" style="display: flex; align-items: center; gap: 12px; padding: 16px 20px; background: var(--bg); border: 1px solid var(--border); border-radius: 10px; text-decoration: none; color: var(--text); transition: border-color 0.2s;">
                    <span style="font-size: 1.5rem;">üöÇ</span>
                    <div>
                        <div style="font-weight: 600;">Railway</div>
                        <div style="font-size: 0.85rem; color: var(--text-muted);">One-click deploy from GitHub</div>
                    </div>
                </a>
                <a href="https://m.do.co/c/e21d46acdb38" target="_blank" rel="noopener" style="display: flex; align-items: center; gap: 12px; padding: 16px 20px; background: var(--bg); border: 1px solid var(--border); border-radius: 10px; text-decoration: none; color: var(--text); transition: border-color 0.2s;">
                    <span style="font-size: 1.5rem;">üåä</span>
                    <div>
                        <div style="font-weight: 600;">DigitalOcean</div>
                        <div style="font-size: 0.85rem; color: var(--text-muted);">$200 free credit to start</div>
                    </div>
                </a>
            </div>
            <p style="margin-top: 16px; font-size: 0.85rem; color: var(--text-muted);">
                Check our <a href="/docs.html" style="color: var(--accent);">deployment guide</a> for step-by-step instructions.
            </p>
        </div>

        <div class="email-capture">
            <h3>üîî Get x402 Updates</h3>
            <p>Weekly insights on the agent economy. No spam.</p>
            <form class="email-form" onsubmit="captureEmail(event)">
                <input type="email" id="emailInput" placeholder="you@example.com" required>
                <button type="submit">Subscribe</button>
            </form>
        </div>
        
        <footer>
            <p>Built by <a href="/">Agent Index</a> ‚Äî The discovery layer for x402 AI agents</p>
        </footer>
    </div>
    
    <script>
        async function checkEndpoint() {
            const url = document.getElementById('urlInput').value.trim();
            if (!url) return;
            
            const btn = document.getElementById('checkBtn');
            const loading = document.getElementById('loading');
            const results = document.getElementById('results');
            const cta = document.getElementById('cta');
            
            btn.disabled = true;
            loading.classList.add('show');
            results.classList.remove('show');
            results.innerHTML = '';
            cta.style.display = 'none';
            
            try {
                // Try to fetch the endpoint
                const startTime = Date.now();
                const response = await fetch(url, { 
                    method: 'GET',
                    mode: 'cors',
                    headers: { 'Accept': 'application/json' }
                }).catch(() => null);
                const latency = Date.now() - startTime;
                
                let resultHtml = '';
                
                if (!response) {
                    // Could be CORS or unreachable
                    resultHtml = `
                        <div class="result-card warning">
                            <div class="result-header">
                                <div class="result-icon warning">‚ö†Ô∏è</div>
                                <div>
                                    <div class="result-title">Could Not Connect</div>
                                    <div class="result-subtitle">${url}</div>
                                </div>
                            </div>
                            <div class="result-details">
                                <div class="detail-row">
                                    <span class="detail-label">Status</span>
                                    <span class="detail-value bad">Unreachable or CORS blocked</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Suggestion</span>
                                    <span class="detail-value">Try from server-side or check if endpoint is public</span>
                                </div>
                            </div>
                        </div>
                    `;
                } else if (response.status === 402) {
                    // x402 enabled!
                    const headers = {};
                    response.headers.forEach((v, k) => headers[k.toLowerCase()] = v);
                    
                    const paymentHeader = headers['x-payment'] || headers['www-authenticate'] || '';
                    const priceMatch = paymentHeader.match(/price[=:]?\s*"?(\d+\.?\d*)"/i);
                    const price = priceMatch ? priceMatch[1] : 'Unknown';
                    
                    resultHtml = `
                        <div class="result-card success">
                            <div class="result-header">
                                <div class="result-icon success">‚úì</div>
                                <div>
                                    <div class="result-title">x402 Enabled!</div>
                                    <div class="result-subtitle">${url}</div>
                                </div>
                            </div>
                            <div class="result-details">
                                <div class="detail-row">
                                    <span class="detail-label">Status</span>
                                    <span class="detail-value good">402 Payment Required</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Price</span>
                                    <span class="detail-value">$${price} USDC/call</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Latency</span>
                                    <span class="detail-value">${latency}ms</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Protocol</span>
                                    <span class="detail-value good">x402</span>
                                </div>
                            </div>
                        </div>
                    `;
                    cta.style.display = 'block';
                } else if (response.ok) {
                    // Not x402 but works
                    resultHtml = `
                        <div class="result-card warning">
                            <div class="result-header">
                                <div class="result-icon warning">üì°</div>
                                <div>
                                    <div class="result-title">Not x402 Enabled</div>
                                    <div class="result-subtitle">${url}</div>
                                </div>
                            </div>
                            <div class="result-details">
                                <div class="detail-row">
                                    <span class="detail-label">Status</span>
                                    <span class="detail-value">${response.status} ${response.statusText}</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">x402</span>
                                    <span class="detail-value bad">Not detected</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Latency</span>
                                    <span class="detail-value">${latency}ms</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Suggestion</span>
                                    <span class="detail-value">Add x402 to monetize this endpoint</span>
                                </div>
                            </div>
                        </div>
                    `;
                } else {
                    resultHtml = `
                        <div class="result-card error">
                            <div class="result-header">
                                <div class="result-icon error">‚úï</div>
                                <div>
                                    <div class="result-title">Error</div>
                                    <div class="result-subtitle">${url}</div>
                                </div>
                            </div>
                            <div class="result-details">
                                <div class="detail-row">
                                    <span class="detail-label">Status</span>
                                    <span class="detail-value bad">${response.status} ${response.statusText}</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Latency</span>
                                    <span class="detail-value">${latency}ms</span>
                                </div>
                            </div>
                        </div>
                    `;
                }
                
                results.innerHTML = resultHtml;
                results.classList.add('show');
                
            } catch (err) {
                results.innerHTML = `
                    <div class="result-card error">
                        <div class="result-header">
                            <div class="result-icon error">‚úï</div>
                            <div>
                                <div class="result-title">Check Failed</div>
                                <div class="result-subtitle">${url}</div>
                            </div>
                        </div>
                        <div class="result-details">
                            <div class="detail-row">
                                <span class="detail-label">Error</span>
                                <span class="detail-value bad">${err.message}</span>
                            </div>
                        </div>
                    </div>
                `;
                results.classList.add('show');
            } finally {
                btn.disabled = false;
                loading.classList.remove('show');
            }
        }
        
        async function captureEmail(e) {
            e.preventDefault();
            const email = document.getElementById('emailInput').value;
            
            try {
                await fetch('/api/subscribe', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, source: 'endpoint-checker' })
                });
                e.target.innerHTML = '<p style="color: var(--green);">‚úì Subscribed!</p>';
            } catch (err) {
                e.target.innerHTML = '<p style="color: var(--green);">‚úì Thanks!</p>';
            }
        }
        
        // Check on Enter
        document.getElementById('urlInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') checkEndpoint();
        });
    </script>
</body>
</html>
